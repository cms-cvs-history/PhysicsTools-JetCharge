process chargeAnalysis = {
    include "FWCore/MessageService/data/MessageLogger.cfi"

    source = PoolSource {
        untracked vstring fileNames = {
            '/store/RelVal/2007/6/4/RelVal-RelVal150pre5TTbar-1180981428/0000/8EA0C740-0513-DC11-8880-001731AF684D.root',
            '/store/RelVal/2007/6/4/RelVal-RelVal150pre5TTbar-1180981428/0000/B4FA23F0-0013-DC11-BFAD-003048767D3D.root',
            '/store/RelVal/2007/6/4/RelVal-RelVal150pre5TTbar-1180981428/0000/FAFA7ECB-3813-DC11-8942-00304875AB59.root'
            #'file:ttbar.root'
        }
    }

    untracked PSet maxEvents = { untracked int32 input = -1 }

    //// ===== STANDARD (not filtered) tracks =================
    module jetChargeProducer  = jetChargeProducer   from "PhysicsTools/JetCharge/data/JetChargeProducer.cfi"
    module jetChargeAnalyzer  = jetChargeAnalyzer   from "PhysicsTools/JetCharge/test/JetChargeAnalyzer.cfi"
        replace jetChargeAnalyzer.dir = "ctfWithMaterialTracks"

    //// ===== REQUIRE 8 HITS (no ghost tracks) =================
    module  trackWithVertexSelector8Hits = trackWithVertexSelector from "PhysicsTools/RecoSelectors/data/TrackWithVertexSelector.cfi"
        replace trackWithVertexSelector8Hits.useVtx = false
        //replace trackWithVertexSelector8Hits.nVertices = 1

    module  jetTrackAssociator8Hits = ic5JetTracksAssociatorAtVertex from "RecoJets/JetAssociationProducers/data/ic5JetTracksAssociatorAtVertex.cfi"
        replace jetTrackAssociator8Hits.tracks = trackWithVertexSelector8Hits

    module jetChargeProducer8Hits  = jetChargeProducer   from "PhysicsTools/JetCharge/data/JetChargeProducer.cfi"
        replace jetChargeProducer8Hits.src = jetTrackAssociator8Hits

    module jetChargeAnalyzer8Hits  = jetChargeAnalyzer   from "PhysicsTools/JetCharge/test/JetChargeAnalyzer.cfi"
        replace jetChargeAnalyzer8Hits.src = jetChargeProducer8Hits
        replace jetChargeAnalyzer8Hits.dir = "ctfWith8Hits"

    //// ===== REQUIRE VERTEX (no pileup) =================
    module  trackWithVertexSelectorVtx = trackWithVertexSelector from "PhysicsTools/RecoSelectors/data/TrackWithVertexSelector.cfi"
        replace trackWithVertexSelectorVtx.useVtx = true
        replace trackWithVertexSelectorVtx.nVertices = 1
    module  jetTrackAssociatorVtx = ic5JetTracksAssociatorAtVertex from "RecoJets/JetAssociationProducers/data/ic5JetTracksAssociatorAtVertex.cfi"
        replace jetTrackAssociatorVtx.tracks = trackWithVertexSelectorVtx
    module jetChargeProducerVtx  = jetChargeProducer   from "PhysicsTools/JetCharge/data/JetChargeProducer.cfi"
        replace jetChargeProducerVtx.src = jetTrackAssociatorVtx
    module jetChargeAnalyzerVtx  = jetChargeAnalyzer   from "PhysicsTools/JetCharge/test/JetChargeAnalyzer.cfi"
        replace jetChargeAnalyzerVtx.src = jetChargeProducerVtx
        replace jetChargeAnalyzerVtx.dir = "ctfWith8HitsAndVtx"

    service = TFileService { string fileName = "allPlots.root" }

    path p8 = { trackWithVertexSelector8Hits, jetTrackAssociator8Hits, jetChargeProducer8Hits,  jetChargeAnalyzer8Hits }
    path pv = { trackWithVertexSelectorVtx, jetTrackAssociatorVtx, jetChargeProducerVtx,  jetChargeAnalyzerVtx }
    path p =  {  jetChargeProducer, jetChargeAnalyzer }

    untracked PSet options = { untracked bool wantSummary = true }
}
